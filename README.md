# SeaMarine Light Novel Translator

> 일본어 라이트 노벨 EPUB을 **몇 번의 클릭**만으로 **한국어 번역본 EPUB**으로 만들어주는 Windows용 GUI 도구.  
> GUI는 **PySide6 + QML**, 비즈니스 로직은 **Python** 기반.  
> **현재 버전: 2.1.0**

[![Version](https://img.shields.io/badge/version-2.1.0-blue)](#) [![Latest Release](https://img.shields.io/github/v/release/rainBuildingTree/seamarine-lightnovel-translator?label=Releases)](https://github.com/rainBuildingTree/seamarine-lightnovel-translator/releases) ![Platform](https://img.shields.io/badge/platform-Windows-0078D6?logo=windows) ![Made with](https://img.shields.io/badge/made%20with-Python%20%26%20PySide6-306998)

---

## 소개

**SeaMarine Light Novel Translator**는 일본어 `.epub` 라이트 노벨을 **구조를 보존**한 채 한국어로 번역합니다.  
번역 파이프라인(루비 제거 → 고유명사 추출/사전 편집 → 전체 번역 → 제목/목차 번역 → 검수 번역 → 원어 병기/이미지 번역)을 제공하며, **고급 번역 모드**로 단계별 수동 실행도 가능합니다.

- **GUI:** PySide6 + QML  
- **번역 엔진:** Google **Gemini** API (사용자 API Key 필요)  
- **출력:** 원본과 동일한 파일명으로 변환된 `.epub` (문서 폴더 내 전용 경로)

> 이 README는 레포지토리의 실제 동작 코드가 위치한 **`seamarine2/`** 디렉토리를 기준으로 작성되었습니다.  
> **1.x.x** 버전 정보는 전부 제외했고, **2.1.0** 사용 흐름에 맞춰 업데이트했습니다.

---

## 설치

1. **Releases에서 ZIP 다운로드**  
   → https://github.com/rainBuildingTree/seamarine-lightnovel-translator/releases  
2. **압축 해제**  
   - **통째로** 폴더에 풀어두세요. (EXE만 빼서 실행하면 리소스/경로 문제로 깨질 수 있습니다.)  
3. **실행**  
   - 압축 해제한 폴더 내 `SeaMarine_LightNovel_Translator.exe` 더블 클릭  
   - 별도 설치/관리자 권한 불필요

**요구사항**
- OS: Windows 10/11 (x64)
- 네트워크: **항상 필요**(클라우드 API 호출)
- 계정: Google **Gemini API Key** (무료/유료 가능)

---

## 사용법

> 첨부된 PDF의 화면(버튼/단계 번호)을 **그대로** 따라가면 됩니다.  
> 아래는 각 화면의 **번호/버튼 이름**과 **실행 순서**를 텍스트로 재구성한 것입니다.

### 0) 첫 실행 & API Key 등록
1. **시작하기** 버튼 클릭 → 프로그램 시작  
2. **API Key 찾기** 버튼 클릭 → 브라우저에서 Gemini API 키 생성/확인 후 복사  
3. 프로그램의 **API Key 입력 칸**에 붙여넣기  
4. **등록** 버튼 클릭  
   - 최초 1회만 필요  
   - 키는 로컬 **문서폴더/`SeaMarine_AI_Translate_Tool`/`config.json`** 에 저장됨
   - 등록 실패 시: 키 재확인 후 2~4번 재시도  
   - Gemini 서버 상태에 따라 일시적으로 실패할 수 있음(잠시 후 재시도)

---

### 1) 가장 기본적인 번역
1. **파일 선택** → 번역할 **EPUB** 선택  
2. **번역 시작** 클릭 → 아래 단계가 **자동** 진행  
   - 루비 제거  
   - 고유명사 추출 → **사전 수정**  
   - **전체 번역**  
   - **제목/목차 번역**  
   - **검수 번역**(미번역/잔존 외국어 문장 추가 처리)  
3. **고유명사 사전 확인/수정**  
   - 추출된 목록에서 **원어/번역**을 수정·추가·삭제  
   - **저장** 후 **뒤로가기**(수정분이 이후 번역에 반영됨)  
4. 결과 확인  
   - 출력 위치:  
     ```
     문서폴더\SeaMarine_AI_Translate_Tool\Output\
     ```
     원본과 **동일한 파일명**으로 완성된 EPUB 생성

**문제 발생 시 팁**
- 변환 에러나 EPUB 구조 문제: **Calibre**에서 **EPUB→EPUB** 재변환 후 다시 시도  
- 번역 중단/비정상 완료: **번역 시작**을 한 번 더 눌러 **재시도**  
- Gemini **Rate Limit** 의심 시: **시간 간격** 두고 재시도

---

### 2) 고유명사 사전 수정
- **원어**: 수정 가능  
- **번역**: 수정 가능  
- **삭제**: 선택 항목 삭제  
- **추가**: 사전에 항목 추가  
- **저장**: **반드시** 눌러야 적용됨  
- **뒤로가기**: 메인으로 이동 → 진행 중인 번역에 **수정된 사전**이 즉시 반영되어 이어서 진행

---

### 3) 설정
- **Google Gemini API 재설정**: 키 교체/변경  
  - 무료 키로 번역 중 **Rate Limit**가 잦으면 종료 후 새로운 키 등록 → 이어서 진행 가능  
- **사용자 사전(전역)** 편집: 모든 EPUB에 공통 적용  
- **번역 파이프라인 설정**: 기본 모드에서 실행할 **작업 체크** 및 저장  
- **AI/API 세부 설정**: 작업별 Gemini 모델/프롬프트/샘플링 파라미터 등  
- **프로그램 정보**: 기본 정보 화면

#### 일반 설정 (권장 기준)
- **최대 청크 사이즈**: 한 번에 번역시킬 **문자 수**.  
  - **크면 효율↑**(요청 수 감소) / **너무 크면 품질↓**(맥락 손실 가능)  
- **최대 동시 요청 수**: 병렬 요청 개수.  
  - 유료/할당 여유: **값↑** 가능 / 무료: 너무 크게 잡지 말 것  
- **요청 간 지연(초)**: Rate Limit 회피용 대기 시간. 0도 가능(내부 재시도 로직 존재)  
- **프로그램 초기화**: 모든 설정 초기화(API Key 포함).  
  - **새 버전** 설치 후 1회 초기화 권장

#### 작업별 Gemini 설정 (모든 작업 공통)
- **모델**: `2.5 flash`, `2.5 pro`, `2.0 flash` 권장(상황 따라 선택)  
- **시스템 프롬프트**:  
  - 전체 번역 / 제목·목차 / 검수 번역에 각자 원하는 번역 지침 입력 가능  
  - 필요 시 **검열 회피용 프롬프트**를 별도 사용(정책/법률 준수 전제)  
- **Temperature / Top P / Frequency Penalty**: 모델 지원 여부 확인 후 조정  
  - 일부 모델은 **Frequency Penalty 미지원** → 미지원이면 `0`으로 둘 것  
- **Thinking Budget**: 모델/버전에 맞게 조절  
  - `2.0-` 계열: **비활성화** 권장  
  - `2.5 pro`: 비활성화 **또는** `≥ 128` 권장  
  - `2.5-flash-lite`: Thinking 오류 많아 **비추천**

---

### 4) 번역 파이프라인(작업)
1. **루비 제거**: EPUB 내 루비(후리가나) 삭제  
2. **고유명사 추출**: 본문에서 고유명사 자동 추출(Gemini 사용)  
3. **고유명사 사전 수정**: 추출 사전의 **수정/삭제/추가**  
4. **전체 번역**: 본문 전체 번역  
5. **제목/목차 번역**: 메타데이터 및 목차 번역  
6. **검수 번역**: 잔존 외국어(영어 제외) 문장 **추가 재번역**  
7. **원어 병기**: 번역문과 원문 **병기 표기**  
8. **이미지 번역**: 삽화 내 텍스트 인식 후 번역(비용 **많이 듦**)

> 원하는 작업만 선택해서 저장하면, **기본 모드의 번역 시작** 시 해당 작업들만 순차 실행됩니다.

---

### 5) AI / API 세부 설정
1. **일반 설정**: 동시 요청 수, 청크 크기, 요청 간 딜레이  
2~6. **작업별 Gemini 설정**: 각 작업의 모델/프롬프트/샘플링/Thinking Budget  
   - 설정 변경으로 **번역 실패** 가능 → 확실히 이해 후 변경  
   - **Google AI Studio**에서 설정을 **미리 실험**해보고 반영하는 것을 권장

---

### 6) 고급 번역 모드
- **파일 선택** → 원하는 **단일 작업**을 골라 **개별 실행**  
  - 한 번에 **한 가지 작업**만 가능  
- 활용 예:
  1. 파이프라인 설정 바꾸기 귀찮을 때 **단건 실행**  
  2. 1차 번역 후 **덜 번역된 부분**만 다시 **전체 번역**  
  3. 번역이 끝난 파일에 **원어 병기/이미지 번역** 등 **보충 작업** 수행  
- 주의: **이미지 번역 후**에는 **원어 병기**가 제대로 작동하지 않을 수 있음

---

### 7) 추가 사항
- **출력 위치**  
문서폴더\SeaMarine_AI_Translate_Tool\Output\
번역 완료 EPUB은 **원래 파일명**으로 저장
- **중간 저장 없이 새로 번역하고 싶다면**  
문서폴더\SeaMarine_AI_Translate_Tool\Output<EPUB파일명과_동일한_폴더>
를 **삭제**하고 처음부터 다시 진행
- **나만의 설정 파일 공유**  
- 파일:  
  ```
  문서폴더\SeaMarine_AI_Translate_Tool\config_data.json
  ```  
- 공유 전 **API Key 값 제거**(예: `"AI~~~": ""` 형태로 비워두기)  
- 공유받은 쪽은 해당 파일을 동일 경로로 **교체**(자신의 API Key는 **다시 등록** 필요)  
- **로그 파일**: 삭제해도 무방

---

## 프로젝트 구조 (요약)

> 실제 동작 코드는 **`seamarine2/`** 에 있습니다. 레거시/실험 디렉토리는 현재 사용하지 않습니다.

seamarine2/
├─ (GUI) QML 뷰 파일들    
├─ (Python) 번역 파이프라인/작업 모듈    
├─ (Python) 설정/유틸리티/리소스 로더    
└─ (빌드 스펙/리소스) 실행파일 패키징 관련    

- GUI(QML) ←→ ViewModel(Python) ←→ Worker(Python) 구조  
- 버튼 클릭 등 UI 이벤트가 ViewModel을 타고 Worker로 전달되어 **비동기 작업** 수행  
- 결과는 ViewModel을 통해 화면에 **즉시 반영**

---

## 자주 묻는 질문(FAQ)

- **Q. 인터넷 없이 되나요?**  
  A. **안 됩니다.** 클라우드 API 호출이므로 항상 연결이 필요합니다.

- **Q. 번역이 멈췄습니다.**  
  A. Gemini **Rate Limit**일 수 있습니다. **시간 간격**을 두고 재시도하거나, **동시 요청 수**를 낮추세요. 무료 키는 특히 제한이 심합니다.

- **Q. EPUB이 자꾸 에러 납니다.**  
  A. Calibre로 **EPUB→EPUB 재변환** 후 다시 시도하세요. 구조가 깨끗해집니다.

- **Q. 이미지 번역이 느립니다/비용이 큽니다.**  
  A. 맞습니다. 이미지 OCR/번역은 **API 사용량이 큽니다.** 정말 필요할 때만 쓰세요.

---

## 라이선스

- 아직 라이선스를 정하지 않았습니다. 배포/기여 전에 별도 공지 전까지는 **모든 권리 보유(All rights reserved)**로 간주하세요.

---

## 이슈/기여

- 버그/요청은 **GitHub Issues**에 등록  
- PR 시에는 **2.1.0 파이프라인/설정 체계**를 기준으로 맞춰주세요(이전 1.x.x 기준 구현은 받지 않습니다)

---

## 요약

- **Releases ZIP** 다운 → **압축 해제** → **EXE 실행**  
- **API Key 등록** → **파일 선택** → **번역 시작**  
- 결과는 `문서폴더\SeaMarine_AI_Translate_Tool\Output\`에서 확인  
- 문제가 생기면 **Calibre 재변환**, **시간 두고 재시도**, **동시 요청 수 조정**

> 사소한 포장 없이 한 줄 평: **설치 간단, 버튼 몇 개, 결과 깔끔.**  
> 다만 **API 키/과금/속도 제한**은 당신 몫입니다.

